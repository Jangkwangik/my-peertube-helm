nameOverride: ""
fullnameOverride: ""
replicaCount: 1

image:
  registry: "docker.io"
  repository: chocobozzz/peertube
  pullPolicy: IfNotPresent
  tag: ""

imagePullSecrets: []

containerCommand:
  - gosu
  - peertube
  - npm
  - start

extraEnv: []
envFrom: []
initcontainers: {}
podAnnotations: {}
podLabels: {}
podSecurityContext: {}
securityContext: {}
extraVolumes: []
extraVolumeMounts: []
tolerations: []
affinity: {}
nodeSelector: {}

# -----------------------------------------------------------
# [중요 변경 1] 저장소(Persistence) 활성화 (AWS gp2 사용)
# -----------------------------------------------------------
persistence:
  enabled: true             # false -> true로 변경
  annotations: {}
  accessModes:
    - ReadWriteOnce
  storageClassName: "gp2"   # AWS용 스토리지 클래스 지정
  storage: "10Gi"
  existingClaim: ""

resources:
  limits:
    cpu: 2000m
    memory: 2Gi
  requests:
    cpu: 500m
    memory: 1Gi

livenessProbe:
  httpGet:
    path: /
    port: peertube

readinessProbe:
  httpGet:
    path: /
    port: peertube

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: "peertube-sa"

# -----------------------------------------------------------
# [중요 변경 2] 서비스 타입을 LoadBalancer로 변경 (자동 외부 노출)
# -----------------------------------------------------------
service:
  enabled: true
  type: LoadBalancer        # ClusterIP -> LoadBalancer로 변경
  port: 80

# -----------------------------------------------------------
# [중요 변경 3] Ingress 끄기 (LoadBalancer를 쓰므로 끔)
# -----------------------------------------------------------
ingress:
  enabled: false            # true -> false (초기 설정 단순화)
  className: "nginx"
  annotations: {}
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

peertube:
  log_level: info
  trust_proxy: '10.0.0.0/8'
  webserver_hostname: chart-example.local
  webserver_port: 80
  webserver_https: false
  secret: "changeme123"      # 임시 시크릿 키 추가
  existingSecret: ""
  existingSecretKey: "secret"

  admin:
    email: "admin@example.com"
    password: "password123!" # 초기 관리자 비밀번호 설정

  s3:
    enabled: false

  smtp:
    enabled: false           # SMTP 비활성화 (나중에 설정)

externalDatabase:
  enabled: false

externalValkey:
  enabled: false

# -----------------------------------------------------------
# [중요 변경 4] PostgreSQL 비밀번호 설정 (에러 해결)
# -----------------------------------------------------------
postgresql:
  enabled: true
  auth:
    database: peertube_production
    username: peertube
    password: "dbpassword123!"         # 비밀번호 필수 입력
    postgresPassword: "dbpassword123!" # 관리자 비번 필수 입력
    existingSecret: ""

# -----------------------------------------------------------
# [중요 변경 5] Valkey(Redis) 비밀번호 설정 (에러 해결)
# -----------------------------------------------------------
valkey:
  enabled: true
  auth:
    password: "redispassword123!"      # 비밀번호 필수 입력
    existingSecret: ""
    existingSecretPasswordKey: ""