# =============================================================================
# PeerTube Helm - Final Corrected values.yaml
# =============================================================================

replicaCount: 1

image:
  registry: "docker.io"
  repository: chocobozzz/peertube
  pullPolicy: IfNotPresent
  tag: "v6.3.3"

serviceAccount:
  create: true
  automount: true
  name: "peertube-sa"

persistence:
  enabled: true
  accessModes: ["ReadWriteOnce"]
  storageClassName: "gp2"
  storage: "10Gi"

service:
  enabled: true
  type: LoadBalancer
  port: 80

peertube:
  log_level: info
  trust_proxy: '10.0.0.0/8'
  webserver_hostname: "localhost"
  webserver_port: 80
  webserver_https: false
  secret: "peertube-secret-random-12345"

  admin:
    email: "admin@example.com"
    password: "원하는_관리자_비밀번호"

  s3:
    enabled: true
    endpoint: "s3.amazonaws.com"
    region: "us-east-1"
    bucket: "사용자님의_S3_버킷명"
    accessKey: "" # ArgoCD에서 입력하거나 --set으로 전달됨
    secretKey: "" # ArgoCD에서 입력하거나 --set으로 전달됨

# [에러 해결 포인트 1] 외부 DB 설정 - 하위 구조 전체 포함
externalDatabase:
  enabled: true
  hostname: "사용자님의_RDS_ENDPOINT"
  database: "peertube"
  username: "peertube"
  password: "사용자님의_RDS_PASSWORD"
  existingSecret: ""
  existingSecretKeys:
    hostname: ""
    database: ""
    username: ""
    password: ""

# [에러 해결 포인트 2] 외부 Valkey 설정 - 하위 구조 전체 포함 ⭐
externalValkey:
  enabled: false
  hostname: ""
  password: ""
  existingSecret: ""
  existingSecretKey: ""

postgresql:
  enabled: false

# 내부 캐시 사용
valkey:
  enabled: true
  auth:
    password: "peertube-valkey-password"

resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 512Mi